Почтовым ящиком (Mailslot) называется объект ядра операционной
системы, который обеспечивает передачу данных от процессов-клиентов к
процессам-серверам, выполняющимся на компьютерах в одной локальной
сети.

Процесс, создающий почтовый ящик называется ***сервером почтового
ящика***. 
Процессы, которые связываются с почтовым ящиком, называются
***клиентами почтового ящика***.

![[Pasted image 20241203232922.png]]

```cpp
// -- создать почтовый ящик
// Назначение: функция предназначена для создания почтового
// ящика
HANDLE CreateMailslot
(
LPCTSTR pname, // [in] символическое имя ящика
DWORD maxms, // [in] максимальная длина сообщения
DWORD timeo, // [in] интервал ожидания
LPSECURITY_ATTRIBUTES sattr // [in] атрибуты безопасности
);
// Код возврата: в случае успешного завершения функция
// возвращает дескриптор почтового ящика, иначе
// значение INVALID_HANDLE_VALUE
// Примечание: pname - указывает на строку именем канала в
// локальном формате;
// timeo – параметр устанавливает время ожидания
// cобщения функцией ReadFile; для задания бесконечного
// ожидания, следует установить значение
// MAILSLOT_WAIT_FOREVER;
// sattr – для установки атрибутов безопасности
// по умолчанию следует установить значение NULL
```

```cpp
// -- открыть почтовый ящик
// Назначение: функция предназначена для подключения клиента
// к почтовому ящику
HANDLE CreateFile
(
LPCTSTR mname, // [in] символическое имя почтового ящика
DWORD accss, // [in] чтение или запись
DWORD share, // [in] режим совместного использования
LPSECURITY_ATTRIBUTES sattr // [in] атрибуты безопасности
DWORD oflag, // [in] флаг открытия почтового ящика
DWORD aflag, // [in] флаги и атрибуты
HANDLE exten, // [in] дополнительные атрибуты
);
// Код возврата: в случае успешного завершения функция
// возвращает дескриптор именованного канала, иначе
// INVALID_HANDLE_VALUE – неудачное завершение
// Примечание:- параметр mname указывается в локальном,
// сетевом или доменном формате: в зависимости от
// способа применения;
// - параметр accss должен принимать значение
// GENERIC_WRITE
// - параметр share может принимать значения
// FILE_SHARE_READ (совместное чтение),
// FILE_SHARE_WRITE (совместная запись),
// FILE_SHARE_READ| FILE_SHARE_WRITE (чтение и запись);
// - параметр sattr для установки атрибутов безопасности
// по умолчанию, следует установить значение NULL;
// - значение параметра oflag всегда устанавливается в
// OPEN_EXISTING(открытие существующего ящика);
// - значение параметра aflag можно установить в NULL,
// что определяет значения флагов и атрибутов по
// умолчанию или установить FILE_ATTRIBUTE_NORMAL;
// - значение параметра exten следует становить в NULL
```

```cpp
// -- получить информацию о почтовом ящике
// Назначение: функция предназначена для получения
// характеристик созданного почтового ящика
BOOL GetMailslotInfo
(
HANDLE hM, // [in] дескриптор почтового ящика
LPDWORD ml, // [out] максимальная длина сообщения
LPDWORD nl, // [out] длина следующего сообщения
LPDWORD nm // [out] количество сообщений
LPDWORD to // [out] интервал ожидания сообщения
);
// Код возврата: в случае успешного завершения функция
// возвращает TRUE, иначе FALSE
```

```cpp
// -- получить информацию о почтовом ящике
// Назначение: функция предназначена для получения
// характеристик созданного почтового ящика
BOOL GetMailslotInfo
(
HANDLE hM, // [in] дескриптор почтового ящика
LPDWORD ml, // [out] максимальная длина сообщения
LPDWORD nl, // [out] длина следующего сообщения
LPDWORD nm // [out] количество сообщений
LPDWORD to // [out] интервал ожидания сообщения
);
// Код возврата: в случае успешного завершения функция
// возвращает TRUE, иначе FALSE
```

```cpp
// -- изменить время ожидания сообщения
// Назначение: функция предназначена для изменения
// одной характеристики почтового ящика –
// интервала времени ожидания
BOOL SetMailslotInfo
(
HANDLE hM, // [in] дескриптор почтового ящика
PDWORD to // [in] новое значение интервала
);
// Код возврата: в случае успешного завершения функция
// возвращает TRUE, иначе FALSE
```

